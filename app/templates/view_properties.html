<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>View Properties</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(to right, #d0f0c0, #a0e3a0);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 40px 15px;
      margin: 0;
    }

    .container {
      max-width: 1100px;
      margin: auto;
    }

    h2.page-title {
      text-align: center;
      font-size: 36px;
      font-weight: bold;
      margin-bottom: 50px;
      color: #2c3e50;
      letter-spacing: 1px;
    }

    .property-card {
      background-color: #ffffff;
      border-radius: 20px;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.08);
      padding: 30px;
      margin-bottom: 40px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .property-card:hover {
      transform: translateY(-7px);
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.12);
    }

    .property-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .property-title {
      font-size: 28px;
      font-weight: 700;
      color: #2d2d2d;
    }

    .property-address {
      font-size: 15px;
      color: #6c757d;
      margin-bottom: 20px;
    }

    .floor-section {
      background-color: #f5f7fa;
      border-radius: 14px;
      padding: 20px;
      margin-top: 15px;
    }

    .floor-title {
      font-weight: 600;
      font-size: 18px;
      color: #444;
      margin-bottom: 12px;
    }

    .appliance-box {
      background-color: #ffffff;
      padding: 15px 20px;
      border-radius: 12px;
      border: 1px solid #e1e1e1;
      margin-bottom: 12px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.05);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .appliance-box:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(0,0,0,0.08);
    }

    .appliance-title {
      font-weight: 600;
      color: #333;
      font-size: 17px;
    }

    .appliance-meta {
      font-size: 14px;
      color: #666;
    }

    .appliance-thumbnail {
      width: 100px;
      height: 100px;
      object-fit: cover;
      border-radius: 10px;
      border: 1px solid #ddd;
      margin-right: 15px;
    }

    .btn-outline-primary,
    .btn-outline-danger,
    .btn-outline-success,
    .btn-outline-secondary {
      border-radius: 10px;
      padding: 7px 16px;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .btn-outline-primary:hover {
      background-color: #6c63ff;
      color: #fff;
      border-color: #6c63ff;
    }

    .btn-outline-danger:hover {
      background-color: #ff6b6b;
      color: #fff;
      border-color: #ff6b6b;
    }

    .btn-outline-success:hover {
      background-color: #4cd137;
      color: #fff;
      border-color: #4cd137;
    }

    .text-muted {
      font-style: italic;
      color: #7a7a7a;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2 class="page-title">üèò Your Properties, Floors & Appliances</h2>

    {% for property in properties %}
      <div class="property-card">
        <div class="property-header">
          <div class="property-title">üè† {{ property.name }}</div>
          <div>
            <a href="/edit_property/{{ property.id }}" class="btn btn-sm btn-outline-primary">‚úèÔ∏è Edit</a>
            <form action="/delete_property/{{ property.id }}" method="post" class="d-inline" onsubmit="return confirm('Delete this property?');">
              <button type="submit" class="btn btn-sm btn-outline-danger">üóëÔ∏è Delete</button>
            </form>
          </div>
        </div>
        <div class="property-address">üìç {{ property.address }}</div>

        {% if floors_per_property[property.id] %}
          {% for floor in floors_per_property[property.id] %}
            <div class="floor-section">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <div class="floor-title">üè¢ Floor: {{ floor.floor_number|capitalize }}</div>
                <a href="/edit_floor/{{ floor.id }}" class="btn btn-sm btn-outline-success">‚úèÔ∏è Edit Floor</a>
              </div>

              {% if floor.appliances %}
                {% for appliance in floor.appliances %}
                  <div class="appliance-box">
                    <div class="d-flex align-items-center">
                      <!-- ‚úÖ Show only front image if exists -->
                      <img src="{% if appliance.front_image %}
                                   {{ url_for('static', path='uploads/' ~ appliance.front_image) }}
                                 {% else %}
                                   {{ url_for('static', path='uploads/default_appliance.jpg') }}
                                 {% endif %}"
                           alt="{{ appliance.name }} Front"
                           class="appliance-thumbnail">

                      <div class="flex-grow-1 ms-3">
                        <div class="d-flex justify-content-between align-items-center">
                          <div class="appliance-title">üì∫ {{ appliance.name }} ({{ appliance.model }})</div>
                          <div>
                            <a href="/edit_appliance/{{ appliance.id }}" class="btn btn-sm btn-outline-secondary">‚úèÔ∏è Edit</a>
                            <form action="/delete_appliance/{{ appliance.id }}" method="post" class="d-inline" onsubmit="return confirm('Delete this appliance?');">
                              <button type="submit" class="btn btn-sm btn-outline-danger">üóëÔ∏è Delete</button>
                            </form>
                          </div>
                        </div>

                        <div class="row mt-2">
                          <div class="col-md-6">
                            <strong>üé® Color:</strong> {{ appliance.color }}<br>
                            <strong>‚öôÔ∏è Status:</strong> {{ appliance.status }}
                          </div>
                          <div class="col-md-6">
                            <strong>üìç Location:</strong> {{ appliance.location }}<br>
                            <strong>üìÜ Warranty:</strong>
                              {% if appliance.warranty_expiry %}
                                {{ appliance.warranty_expiry.strftime('%b %d, %Y') }}
                              {% else %}
                                N/A
                              {% endif %}
                          </div>
                        </div>
                        <a href="/appliance/{{ appliance.id }}" class="btn btn-outline-primary w-100 mt-2">
                          View Details
                        </a>
                      </div>
                    </div>
                  </div>
                {% endfor %}
              {% else %}
                <div class="text-muted">üõ† No appliances on this floor.</div>
              {% endif %}
            </div>
          {% endfor %}
        {% else %}
          <div class="text-muted">üö´ No floors added for this property.</div>
        {% endif %}
      </div>
    {% endfor %}
  </div>
</body>
</html>
