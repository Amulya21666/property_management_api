<h4>Reported Issues</h4>

{% if issues %}
  <ul class="list-group">
    {% for issue in issues %}
      <li class="list-group-item">
        <strong>Appliance:</strong> {{ issue.appliance.name if issue.appliance else 'N/A' }} <br>
        <strong>Description:</strong> {{ issue.description }} <br>
        <strong>Status:</strong> {{ issue.status.value.capitalize() }} <br>
        <strong>Reported by:</strong> {{ issue.tenant.username if issue.tenant else 'N/A' }} <br>
        <strong>Vendor:</strong> {{ issue.vendor.name if issue.vendor else 'Not assigned' }} <br>
        <strong>Date:</strong>
        {% if issue.created_at %}
          {{ issue.created_at.strftime('%Y-%m-%d %H:%M') }}
        {% else %}
          N/A
        {% endif %}

        <!-- âœ… Vendor assignment form: only for pending issues -->
        {% if issue.status.value == "pending" %}
          <form action="/manager/assign_vendor/{{ issue.id }}" method="post" class="mt-2">
            <div class="input-group">
              <select name="vendor_id" class="form-select" required>
                <option value="">Select Vendor</option>
                {% for vendor in vendors %}
                  <option value="{{ vendor.id }}">{{ vendor.name }} ({{ vendor.service_type }})</option>
                {% endfor %}
              </select>
              <button type="submit" class="btn btn-primary btn-sm">Assign</button>
            </div>
          </form>
        {% else %}
          <span class="badge bg-success mt-2">Assigned</span>
        {% endif %}
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p>No issues reported.</p>
{% endif %}
